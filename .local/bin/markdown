#!/usr/bin/env bash

# markdown.sh - Interactive Markdown viewer and presentation tool

# Color formatting
CYAN="\033[0;36m"
YELLOW="\033[1;33m"
GREEN="\033[1;32m"
RESET="\033[0m"

show_help() {
    echo -e "${YELLOW}Markdown Viewer & Presenter Wrapper${RESET}"
    echo -e "Usage: ${CYAN}markdown.sh [options] [markdown_file] [-- arg1 arg2 ...]${RESET}"
    echo -e "\nOptions:"
    echo -e "  ${GREEN}--ppt, --presentation, --powerpoint${RESET}  Run using Marp (presentation tool)"
    echo -e "  ${GREEN}-h, --help${RESET}                        Show this help message"

    echo -e "\nExamples:"
    echo -e "  ${CYAN}./markdown.sh notes.md${RESET}"
    echo -e "  ${CYAN}./markdown.sh --ppt slides.md${RESET}"
    echo -e "  ${CYAN}./markdown.sh slides.md -- -o slides.pdf${RESET}\n"
}

# Default tool
TOOL="glow"

ARGS=()

# Parse arguments
for arg in "$@"; do
    case "$arg" in
        --ppt|--powerpoint|--presentation)
            TOOL="npx @marp-team/marp-cli@latest"
            shift
            ;;
        -h|--help)
            show_help
            exit 0
            ;;
        --)
            shift
            ARGS+=("$@")
            break
            ;;
        *)
            ARGS+=("$arg")
            ;;
    esac
done

# Notify which tool is being used
echo -e "${CYAN}>>> Using ${YELLOW}$TOOL${CYAN} to process markdown...${RESET}"

# Run the tool passing all arguments
$TOOL "${ARGS[@]}"
